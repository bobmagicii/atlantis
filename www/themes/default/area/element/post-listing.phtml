<?php

/**
 * @var Atlantis\Element\PostListing $Element
 * @var Atlantis\Datastore $Posts
 * @var Atlantis\Prototype\BlogPost $Post
 */

$Posts = $Element->GetItemStore();

?>

<div class="PostListing HideTheLastHr <?php echo $Element->GetClassesAttrString() ?>">
	<h2>
		<?php echo $Element->GetTitle() ?>
		<?php if($Element->HasSubtitle()): ?>
		<div class="letter-space-barely font-weight-normal font-size-smaller opacity-75 mb-2"><?php echo $Element->GetSubtitle() ?></div>
		<?php endif; ?>
	</h2>
	<hr class="mt-2 mb-4" />
	<?php foreach($Posts as $Post): ?>
	<div class="Post <?php echo $Post->GetStyleClassAttr() ?>">

		<div class="row align-items-top">
			<div class="col-12">
				<div class="row">
					<div class="col-12 order-2 mt-2">
						<h3 class="d-flex align-items-center">
							<?php if($Post->IsDraft()): ?>
							<i class="flex-grow-0 fas fa-fw fa-sticky-note font-size-smallerer mr-1 HasTooltip" title="Draft"></i>
							<?php elseif($Post->IsPublic()): ?>
							<?php elseif($Post->IsFriendsOnly()): ?>
							<span class="fa-stack fa-2x mr-1 HasTooltip" title="Friends Only">
								<i class="fas fa-fw fa-square fa-stack-2x"></i>
								<i class="fas fa-fw fa-user-friends fa-stack-1x fa-inverse"></i>
							</span>
							<?php elseif($Post->IsNuked()): ?>
							<span class="fa-stack fa-2x mr-1 HasTooltip" title="Nuked">
								<i class="fas fa-fw fa-square fa-stack-2x"></i>
								<i class="fas fa-fw fa-radiation fa-stack-1x fa-inverse"></i>
							</span>
							<?php endif; ?>
							<?php if($Post->IsAdult()): ?>
							<i class="flex-grow-0 fas fa-fw fa-exclamation-square font-size-smallerer text-adult mr-1 HasTooltip" title="Adult Content"></i>
							<?php endif; ?>
							<a class="flex-grow-0" href="<?php echo $Post->GetURL() ?>"><?php echo Atlantis\Util\Filters::SafeForHTML($Post->Title) ?></a>
						</h3>
					</div>
					<div class="col-12 order-1 mt-0">
						<div><a class="text-decoration-none" href="<?php echo $Post->URL ?>"><?php echo $Post->DateCreated->Format('F jS g:ia') ?></a></div>
					</div>
					<?php if($Element->GetShowSourceBlog()): ?>
					<div class="col-12 order-3 mt-2">
						<div class="About">
							From <a class="Source" href="<?php echo $Post->Blog->URL ?>"><?php echo $Post->Blog->Title ?></a>
							By <a class="Authour" href="<?php echo $Post->User->URL ?>"><?php echo $Post->User->Alias ?></a>
						</div>
					</div>
					<?php endif; ?>
				</div>
			</div>
		</div>

	</div>
	<hr class="mt-4 mb-4" />
	<?php endforeach; ?>
	<?php if(!$Posts->Count()): ?>
	<div class="p-4 text-center font-italic">
		No posts here yet.
	</div>
	<?php endif; ?>
</div>
